{% extends "base.html" %}
{% block content %}
<h1>Patient Gift MVP</h1>
<p class="muted">Создайте запись подарка (имя + заметка). Сервис выдаст печатную карточку с QR и ссылку на SCAD.</p>

<section class="card">
  <h2>Новая запись</h2>
  <form method="post" action="/admin/create">
    {% if admin_token_required %}
      <input type="hidden" name="token" value="{{ admin_token }}" />
    {% endif %}
    <label>
      Имя пациента
      <input name="patient_name" required minlength="2" placeholder="Например: Анна" />
    </label>
    <label>
      Заметка (не мед. данные)
      <input name="note" placeholder="Например: Дышите 4–6, всё будет хорошо" />
    </label>
    <label>
      Врач/специалист
      <input name="clinician" placeholder="Например: д-р Иванов" />
    </label>
    <button type="submit">Создать и открыть карточку</button>
  </form>
</section>

<section class="card">
  <h2>Последние записи</h2>
  {% if gifts|length == 0 %}
    <p class="muted">Пока пусто.</p>
  {% else %}
    <table>
      <thead>
        <tr>
          <th>Имя</th>
          <th>Slug</th>
          <th>Создано</th>
          <th>Ссылки</th>
        </tr>
      </thead>
      <tbody>
        {% for g in gifts %}
        <tr>
          <td>{{ g.patient_name }}</td>
          <td><code>{{ g.slug }}</code></td>
          <td class="muted">{{ g.created_at }}</td>
          <td>
            <a href="/g/{{ g.slug }}">лендинг</a>
            · <a href="/g/{{ g.slug }}/print{% if admin_token %}?token={{ admin_token }}{% endif %}">печать</a>
            · <a href="/g/{{ g.slug }}/tag.scad">scad</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</section>
{% endblock %}
